<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Laporan Absensi Harian</title>

  <!-- AdminLTE -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/admin-lte@3.2/dist/css/adminlte.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
</head>

<body class="hold-transition sidebar-mini">
<div class="wrapper">

  <!-- Navbar -->
  <nav class="main-header navbar navbar-expand navbar-white navbar-light">
    <span class="navbar-brand font-weight-bold">HRD - Laporan Absensi Harian</span>
  </nav>

  <!-- Content -->
  <div class="content-wrapper p-4">

    <!-- FILTER LAPORAN -->
    <div class="card card-primary">
      <div class="card-header">
        <h3 class="card-title">Filter Laporan</h3>
      </div>
      <div class="card-body">
        <form class="form-inline">
          <label class="mr-2">Tanggal</label>
          <input type="date" class="form-control mr-3">

          <label class="mr-2">Departemen</label>
          <select class="form-control mr-3">
            <option>Semua</option>
            <option>HRD</option>
            <option>Finance</option>
            <option>IT</option>
          </select>

          <button type="submit" class="btn btn-primary">
            <i class="fas fa-search"></i> Filter
          </button>

          <button type="button" class="btn btn-success ml-auto" onclick="exportTableToExcel('tabelAbsensi')">
            <i class="fas fa-file-excel"></i> Export Excel
          </button>
        </form>
      </div>
    </div>

    <!-- TABEL LAPORAN -->
    <div class="card mt-4">
      <div class="card-header bg-dark text-white">
        <h3 class="card-title">Data Absensi Karyawan</h3>
      </div>
      <div class="card-body table-responsive">
        <table class="table table-bordered table-striped" id="tabelAbsensi">
          <thead class="thead-dark">
            <tr>
              <th>No</th>
              <th>NIK</th>
              <th>Nama</th>
              <th>Departemen</th>
              <th>Shift</th>
              <th>Jam Masuk</th>
              <th>Jam Keluar</th>
              <th>Status Masuk</th>
              <th>Status Pulang</th>
              <th>Lokasi</th>
            </tr>
          </thead>
          <tbody>
            <!-- DATA DUMMY -->
            <tr>
              <td>1</td>
              <td>EMP001</td>
              <td>Budi Santoso</td>
              <td>Finance</td>
              <td>Pagi</td>
              <td>08:02</td>
              <td>16:10</td>
              <td><span class="badge badge-success">Tepat Waktu</span></td>
              <td><span class="badge badge-success">Hadir</span></td>
              <td>Kantor Pusat</td>
            </tr>

            <tr>
              <td>2</td>
              <td>EMP002</td>
              <td>Sari Wulandari</td>
              <td>HRD</td>
              <td>Pagi</td>
              <td>08:45</td>
              <td>16:00</td>
              <td><span class="badge badge-warning">Terlambat</span></td>
              <td><span class="badge badge-success">Hadir</span></td>
              <td>Kantor Pusat</td>
            </tr>

            <tr>
              <td>3</td>
              <td>EMP003</td>
              <td>Andi Prasetyo</td>
              <td>IT</td>
              <td>Pagi</td>
              <td>-</td>
              <td>-</td>
              <td><span class="badge badge-danger">Tidak Hadir</span></td>
              <td><span class="badge badge-secondary">-</span></td>
              <td>-</td>
            </tr>

          </tbody>
        </table>
      </div>
    </div>

  </div>
</div>

<!-- SCRIPT -->
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.4/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/admin-lte@3.2/dist/js/adminlte.min.js"></script>

<!-- EXPORT EXCEL -->
<script>
function exportTableToExcel(tableID) {
  var table = document.getElementById(tableID);
  var html = table.outerHTML.replace(/ /g, '%20');

  var url = 'data:application/vnd.ms-excel,' + html;
  var a = document.createElement('a');
  a.href = url;
  a.download = 'laporan-absensi-harian.xls';
  a.click();
}
</script>

</body>
</html>
